

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../_static/favicon.ico">
    
    
      
        <title>The Finite Element Method - Physics Based Animation Toolkit</title>
      
    
    
      
        
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.3394d25b557047e78.min.css" />
        <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
        <link rel="stylesheet" type="text/css" href="../_static/autoclasstoc.css" />
        <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#summary" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Physics Based Animation Toolkit" class="md-header__button md-logo" aria-label="Physics Based Animation Toolkit" data-md-component="logo">
      <img src="../_static/pbat.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Physics Based Animation Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The Finite Element Method
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Q-Minh/PhysicsBasedAnimationToolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Q-Minh/PhysicsBasedAnimationToolkit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../index.html" class="md-tabs__link">
      <span class="md-ellipsis">General</span>
    </a>
  </li>

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="getting_started.html" class="md-tabs__link md-tabs__link--active">
      <span class="md-ellipsis">Tutorial</span>
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../contributing.html" class="md-tabs__link">
      <span class="md-ellipsis">Developers</span>
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Physics Based Animation Toolkit" class="md-nav__button md-logo" aria-label="Physics Based Animation Toolkit" data-md-component="logo">
      <img src="../_static/pbat.svg" alt="logo">
    </a>
    Physics Based Animation Toolkit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Q-Minh/PhysicsBasedAnimationToolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Q-Minh/PhysicsBasedAnimationToolkit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_1">
          <span class="md-ellipsis">General</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="General" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">General</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        <span title="/index.rst (reference label)" class="md-ellipsis">Home</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog.html" class="md-nav__link">
        <span title="/changelog.rst (reference label)" class="md-ellipsis">Changelog</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../license.html" class="md-nav__link">
        <span title="/license.rst (reference label)" class="md-ellipsis">License</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2">
          <span class="md-ellipsis">Tutorial</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorial" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Tutorial</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="getting_started.html" class="md-nav__link">
        <span title="/tutorial/getting_started.rst (reference label)" class="md-ellipsis">Tutorial</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/tutorial/fem.rst (reference label)" class="md-ellipsis">The Finite Element Method</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/tutorial/fem.rst (reference label)" class="md-ellipsis">The Finite Element Method</span>
      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span title="/tutorial/fem.rst#summary (reference label)" class="md-ellipsis">Summary</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3">
          <span class="md-ellipsis">Developers</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Developers</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing.html" class="md-nav__link">
        <span title="/contributing.rst (reference label)" class="md-ellipsis">Contributing</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../style_guide.html" class="md-nav__link">
        <span title="/style_guide.rst (reference label)" class="md-ellipsis">Style Guide</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_of_conduct.html" class="md-nav__link">
        <span title="/code_of_conduct.rst (reference label)" class="md-ellipsis">Code of Conduct</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span title="/tutorial/fem.rst#summary (reference label)" class="md-ellipsis">Summary</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


  <a href="https://github.com/Q-Minh/PhysicsBasedAnimationToolkit/blob/main/docs/source/tutorial/fem.rst" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>

<h1 id="the-finite-element-method">The Finite Element Method<a class="headerlink" href="#the-finite-element-method" title="Permalink to this heading">¶</a></h1>
<p>## Introduction</p>
<p>The Finite Element Method (FEM) is an approach to discretizing space-dependent continuous problems defined on geometrically “complex” domains. As opposed to Finite Differences (FD), which is restricted to regular grid domains, FEM relies on <a class="reference external" href="https://en.wikipedia.org/wiki/Mesh_generation">meshing</a> the problem’s domain (geometric discretization), describing the problem’s solution as a linear combination of piece-wise (i.e. per mesh element) interpolating polynomials (functional discretization), and solving the approximated problem on the mesh. The “Finite” in FEM comes from limiting the approximate solution to be spanned by a “finite-dimensional” functional basis, i.e., the one spanned by the element-wise interpolating polynomials (the basis functions). The “Element” in FEM comes from the polynomials being entirely constructed/defined by the simple geometric primitives composing the mesh, called “elements”.</p>
<p>## Prerequisites</p>
<ul class="simple">
<li><p>Calculus</p></li>
<li><p>Linear Algebra</p></li>
<li><p>Differential equations (optional)</p></li>
</ul>
<p>## Method</p>
<p>Given some space-dependent problem whose solution <span class="math notranslate nohighlight">\(u(X)\)</span> is defined on some
continuous domain <span class="math notranslate nohighlight">\(\Omega\)</span>, FEM first requires a <em>geometric mesh</em> <span class="math notranslate nohighlight">\((V,C) \approx \Omega\)</span>, where <span class="math notranslate nohighlight">\(C\)</span> is a set of cells whose vertices are in <span class="math notranslate nohighlight">\(V\)</span>. From <span class="math notranslate nohighlight">\((V,C)\)</span>, we then construct the <em>FEM mesh</em> <span class="math notranslate nohighlight">\((I,E)\)</span>, where <span class="math notranslate nohighlight">\(I\)</span> is the set of FEM <em>nodes</em> and <span class="math notranslate nohighlight">\(E\)</span> is the set of FEM <em>elements</em>. We now assume that the geometric mesh is the domain itself <span class="math notranslate nohighlight">\((V,C)=\Omega\)</span>.</p>
<p>Nodes <span class="math notranslate nohighlight">\(i \in I\)</span> have corresponding positions <span class="math notranslate nohighlight">\(X_i \in \Omega\)</span> and associated <em>basis functions</em> <span class="math notranslate nohighlight">\(\phi_i(X): \Omega \longrightarrow \mathbb{R}\)</span> such that <span class="math notranslate nohighlight">\(\phi_i(X_j) = \delta_{ij}\)</span>, where <span class="math notranslate nohighlight">\(\delta_{ij}\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Kronecker_delta">Kronecker delta</a>. Such basis functions are defined element-wise by so-called <em>shape functions</em> <span class="math notranslate nohighlight">\(N_i^e(X)\)</span> for pairs <span class="math notranslate nohighlight">\((i,e)\)</span> of adjacent node and element, and vanish in non-adjacent elements. In other words, the support of <span class="math notranslate nohighlight">\(\phi_i(X)\)</span> is the union of its adjacent elements, and evaluating <span class="math notranslate nohighlight">\(\phi_i(X)\)</span> amounts to finding the element <span class="math notranslate nohighlight">\(e\)</span> containing the evaluation point <span class="math notranslate nohighlight">\(X\)</span>, and evaluating <span class="math notranslate nohighlight">\(N_i^e(X)\)</span> there. It is common to refer to this choice of basis function <span class="math notranslate nohighlight">\(\phi_i(X)\)</span> as the “hat” function, because its tip (i.e., its maximal value of 1) is located on node <span class="math notranslate nohighlight">\(i\)</span>, “centered” in its support, while it smoothly decreases to 0 at surrounding nodes. It is also common to refer to these elements as “PK Lagrange elements”, because their shape functions <span class="math notranslate nohighlight">\(N_i^e(X)\)</span> are interpolating polynomials of degree <span class="math notranslate nohighlight">\(K\)</span>.</p>
<table class="docutils data align-default">
<tbody>
<tr class="row-odd"><td><img alt="../_images/geometric.mesh.vs.fem.mesh.jpg" src="../_images/geometric.mesh.vs.fem.mesh.jpg" />
<dl class="field-list simple">
<dt class="field-odd">alt<span class="colon">:</span></dt>
<dd class="field-odd"><p>Geometric mesh vs FEM mesh</p>
</dd>
</dl>
</td>
<td><p>Geometric mesh (left) versus FEM meshes discretized with linear (middle) and quadratic (right) Lagrange elements.</p></td>
</tr>
</tbody>
</table>
<p>With <span class="math notranslate nohighlight">\(n=|I|\)</span>, FEM restricts <span class="math notranslate nohighlight">\(u(X)\)</span> to the class of functions <span class="math notranslate nohighlight">\(u(X) = \sum_{i=1}^{n} u_i \phi_i(X)\)</span>, i.e., linear combinations of coefficients <span class="math notranslate nohighlight">\(u_i\)</span> and basis functions <span class="math notranslate nohighlight">\(\phi_i\)</span> associated with nodes <span class="math notranslate nohighlight">\(i\)</span>. More compactly, <span class="math notranslate nohighlight">\(u(X) = \Phi^T u\)</span>, where</p>
<div class="math notranslate nohighlight">
\[u = \begin{bmatrix}u_1 &amp; \dots &amp; u_{n} \end{bmatrix}^T \in \mathbb{R}^{n}
\Phi = \begin{bmatrix} \phi_1(X) &amp; \dots &amp; \phi_{n}(X) \end{bmatrix}^T \in \mathbb{R}^{n}\]</div>
<p>We say that the basis functions <span class="math notranslate nohighlight">\(\phi_i\)</span> span the function space <span class="math notranslate nohighlight">\(\{ \Phi^T u \;\forall\; u \in \mathbb{R}^{n} \}\)</span>, much like basis vectors <span class="math notranslate nohighlight">\(v_i\)</span> span vector spaces <span class="math notranslate nohighlight">\(V\)</span>. Functions in the FEM function space, i.e., the space spanned by <span class="math notranslate nohighlight">\(\phi_i\)</span>, are uniquely represented by their vector of coefficients <span class="math notranslate nohighlight">\(u\)</span>, much like vectors <span class="math notranslate nohighlight">\(v = v_1 \overrightarrow{i} + v_2\overrightarrow{j} + v_3 \overrightarrow{k}\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> are uniquely represented by their coefficients <span class="math notranslate nohighlight">\(\begin{bmatrix} v_1 &amp; v_2 &amp; v_3 \end{bmatrix}\)</span>.</p>
<table class="docutils data align-default">
<tbody>
<tr class="row-odd"><td><img alt="../_images/fem1D.gif" src="../_images/fem1D.gif" />
<dl class="field-list simple">
<dt class="field-odd">alt<span class="colon">:</span></dt>
<dd class="field-odd"><p>FEM function space 1D</p>
</dd>
</dl>
</td>
<td><p>FEM function space in 1D using linear “hat” basis functions.</p></td>
</tr>
</tbody>
</table>
<p>Such a discrete functional representation allows one to accurately map continuous problems from theory onto computers by needing only to store the discrete and finite-dimensional coefficients <span class="math notranslate nohighlight">\(u\)</span> and FEM mesh <span class="math notranslate nohighlight">\((I,E)\)</span>, assuming an appropriate geometric meshing of the problem domain is readily available. Furthermore, the linearity of <span class="math notranslate nohighlight">\(u(X)\)</span> w.r.t. <span class="math notranslate nohighlight">\(\Phi\)</span> naturally translates solving FEM-discretized problems into solving matrix equations.</p>
<p>### Motivation</p>
<p>As a motivating example, consider a well-known partial differential equation (PDE), the Poisson equation,</p>
<div class="math notranslate nohighlight">
\[\Delta u(X) = f(X),\]</div>
<p>defined on some domain <span class="math notranslate nohighlight">\(\Omega\)</span>, where <span class="math notranslate nohighlight">\(\Delta\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Laplace_operator#:~:text=In%20mathematics%2C%20the%20Laplace%20operator,scalar%20function%20on%20Euclidean%20space.">Laplacian</a> and <span class="math notranslate nohighlight">\(f(X)\)</span> is some known function in space. In other words, we wish to solve for some function <span class="math notranslate nohighlight">\(u(X)\)</span> whose Laplacian is given by <span class="math notranslate nohighlight">\(f(X)\)</span> everywhere in <span class="math notranslate nohighlight">\(\Omega\)</span> (i.e., <span class="math notranslate nohighlight">\(\;\forall\; X \in \Omega\)</span>). Without further analytical specification on the domain <span class="math notranslate nohighlight">\(\Omega\)</span>, there is little we can do to solve such a general problem. In fact, most domains that we care about and that appear in real life don’t have an analytical description. Even if we did have such a description of the domain, it might still be very hard to solve such a problem by hand. We do, however, have powerful meshing tools which can take human-authored complex geometry as input, and produce meshes that accurately approximate the domain as output.</p>
<p>Assuming we have such a mesh at hand, we can discretize the solution <span class="math notranslate nohighlight">\(u(X)\)</span> as described in the previous section, obtaining</p>
<div class="math notranslate nohighlight">
\[\Delta \left[ \sum_j u_j \phi_j(X) \right] = f(X)\]</div>
<div class="math notranslate nohighlight">
\[\sum_j u_j \Delta \phi_j(X) = f(X) ,\]</div>
<p>since only the basis functions <span class="math notranslate nohighlight">\(\phi_j(X)\)</span> are space-dependent. Unfortunately, there are now <span class="math notranslate nohighlight">\(n\)</span> unknowns for a single equation, which is an under-determined problem. However, we can transform this single equation into <span class="math notranslate nohighlight">\(n\)</span> equations by an operator called the Galerkin projection</p>
<div class="math notranslate nohighlight">
\[\int_{\Omega} \sum_j u_j \Delta \phi_j(X) \phi_i(X) \partial \Omega = \int_{\Omega} f(X) \phi_i(X) \partial \Omega .\]</div>
<p>Much like the dot product <span class="math notranslate nohighlight">\(\langle a, b \rangle = a^T b\)</span> for vectors <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(\langle f, g \rangle = \int_{\Omega} f(X)g(X) \partial \Omega\)</span> for functions <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span>. In this sense, much like we say that <span class="math notranslate nohighlight">\(a^T b\)</span> projects the vector <span class="math notranslate nohighlight">\(a\)</span> onto the vector <span class="math notranslate nohighlight">\(b\)</span>, then <span class="math notranslate nohighlight">\(\int_{\Omega} f(X) g(X) \partial \Omega\)</span> projects the function <span class="math notranslate nohighlight">\(f\)</span> onto the function <span class="math notranslate nohighlight">\(g\)</span>. Thus, omitting the dependence on <span class="math notranslate nohighlight">\(X\)</span> to simplify notation, such a projection reveals the <span class="math notranslate nohighlight">\(n\)</span> equations</p>
<div class="math notranslate nohighlight">
\[\sum_j u_j \langle \phi_i, \Delta \phi_j \rangle = \langle f, \phi_i \rangle\]</div>
<p>for <span class="math notranslate nohighlight">\(i=1,2,\dots,n\)</span>, matching the <span class="math notranslate nohighlight">\(n\)</span> unknowns <span class="math notranslate nohighlight">\(u_j\)</span> for <span class="math notranslate nohighlight">\(j=1,2,\dots,n\)</span>. The FEM’s functional discretization of <span class="math notranslate nohighlight">\(u\)</span> and the Galerkin projection thus yield a linear system of equations</p>
<div class="math notranslate nohighlight">
\[\sum_j A_{ij} u_j = f_i\]</div>
<p>where <span class="math notranslate nohighlight">\(A_{ij} = \int_{\Omega} \phi_i \Delta \phi_j \partial \Omega\)</span> and <span class="math notranslate nohighlight">\(f_i = \int_{\Omega} f \phi_i \partial \Omega\)</span>. In matrix notation,</p>
<div class="math notranslate nohighlight">
\[Au=f ,\]</div>
<p>where <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n \times n}\)</span> and <span class="math notranslate nohighlight">\(f \in \mathbb{R}^n\)</span>. We can thus solve for <span class="math notranslate nohighlight">\(u\)</span> using one of the many available implementations of numerical algorithms for solving linear systems of equations.</p>
<div class="tip admonition">
<p class="admonition-title">Tip</p>
<p>Interestingly, the Galerkin method is essentially a residual minimization procedure in function space, much like it is often possible to minimize the residual <span class="math notranslate nohighlight">\(r=Ax-b\)</span> for solving linear systems of equations approximately. Given some functional equation <span class="math notranslate nohighlight">\(L(u(X))=0\)</span>, we know that approximating <span class="math notranslate nohighlight">\(u(X) \approx \Phi^T u\)</span> will yield some error, which manifests as a residual when passing through the functional <span class="math notranslate nohighlight">\(L\)</span>, i.e., <span class="math notranslate nohighlight">\(L(\Phi^T u) = r\)</span>. The Galerkin method then requires that <span class="math notranslate nohighlight">\(\langle r, \phi_i \rangle = 0\)</span> for each basis function <span class="math notranslate nohighlight">\(\phi_i\)</span>. In other words, we ask that the residual be orthogonal (i.e., perpendicular) to the function space spanned by <span class="math notranslate nohighlight">\(\phi_i\)</span>, i.e., any other function <span class="math notranslate nohighlight">\(\Phi^T v\)</span> in this space would yield a worse residual than our solution <span class="math notranslate nohighlight">\(\Phi^T u\)</span>. Similarly, with linear systems, we ask that <span class="math notranslate nohighlight">\(r\)</span> be orthogonal to each basis vector of the map <span class="math notranslate nohighlight">\(A\)</span>, i.e., each column of the matrix <span class="math notranslate nohighlight">\(A\)</span>. This yields <span class="math notranslate nohighlight">\(A^T r = A^T A x - A^T b= 0\)</span>, the well-known <a class="reference external" href="https://en.wikipedia.org/wiki/Ordinary_least_squares#Normal_equations">normal equations</a>.</p>
</div>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>This section showed how a hard-to-solve space-dependent continuous problem defined on a complex domain could be solved accurately using existing numerical techniques through FEM, thus motivating its usefulness in practice. The approach used in our example is called Galerkin FEM, which projects the approximated problem onto the function space used to discretize the solution. Petrov-Galerkin methods allow projecting the approximated problem onto a different function space, i.e., there are two sets of basis functions <span class="math notranslate nohighlight">\(\phi_i\)</span> and <span class="math notranslate nohighlight">\(\psi_i\)</span>, for discretizing the solution and the problem, respectively. In some cases, a projection is not required, i.e., the problem itself already reveals the required number of equations.</p>


  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      Sep 24, 2024
    
  </small>
</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="getting_started.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Tutorial" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Tutorial
            </div>
          </div>
        </a>
      
      
        
        <a href="../contributing.html" class="md-footer__link md-footer__link--next" aria-label="Next: Contributing" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Contributing
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2024-2024, Quoc-Minh Ton-That; MIT License.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    6.2.1.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "toc.follow", "content.tabs.link"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": ""}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.f9d9eeeb247ace16c.min.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../_static/mathjax/tex-mml-chtml.js"></script>
    
  </body>
</html>