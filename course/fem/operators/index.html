
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Physics Based Animation Toolkit.">
      
      
        <meta name="author" content="Quoc-Minh Ton-That">
      
      
        <link rel="canonical" href="https://github.com/Q-Minh/PhysicsBasedAnimationToolkit/course/fem/operators/">
      
      
        <link rel="prev" href="../spatial_integration/">
      
      
        <link rel="next" href="../boundary_conditions/">
      
      
      <link rel="icon" href="../../../_static/imgs/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Operators - Physics Based Animation Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../_static/stylesheets/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#operators" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Physics Based Animation Toolkit" class="md-header__button md-logo" aria-label="Physics Based Animation Toolkit" data-md-component="logo">
      
  <img src="../../../_static/imgs/pbat.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Physics Based Animation Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Operators
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Q-Minh/PhysicsBasedAnimationToolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Q-Minh/PhysicsBasedAnimationToolkit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../c%2B%2B/cpp/" class="md-tabs__link">
          
  
  C++

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../python/python/" class="md-tabs__link">
          
  
  Python

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../workshops/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  FEM

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Physics Based Animation Toolkit" class="md-nav__button md-logo" aria-label="Physics Based Animation Toolkit" data-md-component="logo">
      
  <img src="../../../_static/imgs/pbat.svg" alt="logo">

    </a>
    Physics Based Animation Toolkit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Q-Minh/PhysicsBasedAnimationToolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Q-Minh/PhysicsBasedAnimationToolkit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PBAT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gallery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gallery
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    C++
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            C++
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../c%2B%2B/cpp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../c%2B%2B/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../c%2B%2B/cuda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CUDA
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/FEM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FEM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/geometry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/profiling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/math/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Math
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPU
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Workshops
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Workshops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../workshops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/broad_phase/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Broad Phase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/contact_detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contact Detection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/diffusion_smoothing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diffusion Smoothing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Elasticity
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Elasticity
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/elasticity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elasticity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/elasticity_higher_order/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Higher Order
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/heat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    IPC
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            IPC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/ipc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IPC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/ipc-multi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Material
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/laplace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Laplace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/vbd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VBD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/xpdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XPDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    FEM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            FEM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../method/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Method
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shape_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shape Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spatial_integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spatial Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Operators
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Operators
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#operators" class="md-nav__link">
    <span class="md-ellipsis">
      Operators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shape-function-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Shape function matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quadrature-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Quadrature matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-vector" class="md-nav__link">
    <span class="md-ellipsis">
      Load vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mass-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Mass matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gradient-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Gradient matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#laplacian-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Laplacian matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#divergence-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Divergence matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../boundary_conditions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Boundary Conditions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vector_valued_functions.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vector-valued Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../limitations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Limitations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#operators" class="md-nav__link">
    <span class="md-ellipsis">
      Operators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shape-function-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Shape function matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quadrature-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Quadrature matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-vector" class="md-nav__link">
    <span class="md-ellipsis">
      Load vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mass-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Mass matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gradient-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Gradient matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#laplacian-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Laplacian matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#divergence-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Divergence matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Operators</h1>

<h3 id="operators">Operators<a class="headerlink" href="#operators" title="Permanent link">&para;</a></h3>
<p>Now that we know how to compute shape functions, their derivatives and their integrals, we present a handful of useful FEM operators used to discretize common problems.</p>
<h4 id="shape-function-matrix">Shape function matrix<a class="headerlink" href="#shape-function-matrix" title="Permanent link">&para;</a></h4>
<p>Our first operator will simply evaluate an FEM function <span class="arithmatex">\(u(X)\)</span> at every quadrature point <span class="arithmatex">\(X(\xi_g)\)</span> in every element <span class="arithmatex">\(e\)</span>, where <span class="arithmatex">\(X(\cdot)\)</span> is to be understood as element <span class="arithmatex">\(e\)</span>'s map from the reference element to the domain. Given <span class="arithmatex">\(u(\cdot)\)</span>'s coefficient vector <span class="arithmatex">\(u\)</span>, we thus wish to compute <span class="arithmatex">\(u(X(\xi_g)) = \sum_i u_i \phi(X(\xi_g)) = \Phi(X(\xi_g))^T u\)</span> for every element <span class="arithmatex">\(e\)</span> and every quadrature point <span class="arithmatex">\(\xi_g\)</span> in the reference element. However, we know that <span class="arithmatex">\(\phi_i(X(\xi_g))\)</span> is only non-zero when node <span class="arithmatex">\(i\)</span> is part of element <span class="arithmatex">\(e\)</span>, so we can safely ignore (i.e. set to zero) all <span class="arithmatex">\(\phi_j(X(\xi_g))\)</span> for nodes <span class="arithmatex">\(j\)</span> not in element <span class="arithmatex">\(e\)</span>. In other words, only the shape functions of element <span class="arithmatex">\(e\)</span> need to be evaluated at quadrature points in <span class="arithmatex">\(e\)</span>. This results in a highly sparse operator <span class="arithmatex">\(N\)</span>, whose (sparse) block rows <span class="arithmatex">\(N_e\)</span> are defined as </p>
<div class="arithmatex">\[
N_e = \begin{bmatrix}
\phi_1(X(\xi_1)) &amp; \dots &amp; \phi_n(X(\xi_1)) \\
\vdots &amp; \vdots &amp; \vdots \\
\phi_1(X(\xi_q)) &amp; \dots &amp; \phi_n(X(\xi_q)) \\
\end{bmatrix} \in \mathbb{R}^{q \times n} ,
\]</div>
<p>where <span class="arithmatex">\(q\)</span> is the number of quadrature points and <span class="arithmatex">\(n\)</span> is the number of FEM nodes. Compact storage of <span class="arithmatex">\(N_e\)</span> would store only the shape function values <span class="arithmatex">\(<code>\begin{bmatrix} N_l^e(X(\xi_g)) \end{bmatrix} \in \mathbb{R}^{q \times n^e}</code>\)</span> in a dense matrix using local node indexing <span class="arithmatex">\(l\)</span>. These local dense matrices are often named using the prefix "element", as in "element shape function matrix", or "element hessian" and so on and so forth.</p>
<p>Our full shape function matrix <span class="arithmatex">\(N \in \mathbb{R}^{|E|q \times n}\)</span> is thus sparse, and its application to <span class="arithmatex">\(u\)</span> 
computes <span class="arithmatex">\(u(X^e(\xi_g))\)</span>, yielding a vector <span class="arithmatex">\(N u \in \mathbb{R}^{|E|q \times 1}\)</span>.</p>
<h4 id="quadrature-matrix">Quadrature matrix<a class="headerlink" href="#quadrature-matrix" title="Permanent link">&para;</a></h4>
<p>We introduce a second operator that will enable computing integrals of FEM quantities using matrix operations. Recall from the section on spatial integration that using numerical quadrature, any integral in any element <span class="arithmatex">\(e\)</span> with polynomial integrands of order <span class="arithmatex">\(p\)</span> can be computed exactly given the quadrature weights <span class="arithmatex">\(w_g\)</span> and the jacobian determinants <span class="arithmatex">\(|\det \nabla_\xi X(\xi_g)|\)</span> for a polynomial quadrature rule <span class="arithmatex">\((w_g, \xi_g)\)</span> of order greater than or equal to <span class="arithmatex">\(p\)</span>. Hence, any integrand evaluated at <span class="arithmatex">\(X(\xi_g)\)</span> simply needs to be multiplied by <span class="arithmatex">\(w_g |\det \nabla_\xi X(\xi_g)|\)</span> to be integrated. This hints at the diagonal matrix <span class="arithmatex">\(Q \in \mathbb{R}^{|E|q \times |E|q}\)</span>, which we will name the "Quadrature" matrix, whose diagonal blocks are </p>
<div class="arithmatex">\[
Q_e = \begin{bmatrix}
w_1 |\det \nabla_\xi X(\xi_1)| &amp; 0 &amp; 0 \\
0 &amp; \ddots &amp; 0 \\
0 &amp; 0 &amp; w_q |\det \nabla_\xi X(\xi_q)| \\
\end{bmatrix} \in \mathbb{R}^{q \times q} 
\]</div>
<p>for every element <span class="arithmatex">\(e\)</span>.</p>
<p>This quadrature matrix <span class="arithmatex">\(Q\)</span> is essentially a discrete analog of the inner product <span class="arithmatex">\(\langle u, v \rangle = \int_\Omega u v \partial \Omega\)</span> of functions <span class="arithmatex">\(u, v\)</span> defined on the FEM mesh. For instance, the volume of each domain can be computed easily by the inner product of the unit function, i.e. <span class="arithmatex">\(\langle 1, 1 \rangle = \int_\Omega \partial \Omega = 1_{|E|q}^T Q 1_{|E|q}\)</span>, where we have used the vector of all ones <span class="arithmatex">\(1_{|E|q} \in \mathbb{R}^{|E|q}\)</span>. The volume of individual elements <span class="arithmatex">\(e\)</span> can similarly be computed as $\left[ 
I_{|E| \times |E|} \otimes 1_{q} \right]^T Q \left[ 
I_{|E| \times |E|} \otimes 1_{q} \right] $, where <span class="arithmatex">\(\otimes\)</span> is the <a href="https://en.wikipedia.org/wiki/Kronecker_product">Kronecker product</a>.</p>
<p>Galerkin projections <span class="arithmatex">\(\langle f, \phi \rangle\)</span> also become easy to compute. Consider some function <span class="arithmatex">\(f\)</span> discretized at element quadrature points into matrix <span class="arithmatex">\(F\)</span>, then we can compute its Galerkin projection as <span class="arithmatex">\(N^T Q F\)</span>. </p>
<h4 id="load-vector">Load vector<a class="headerlink" href="#load-vector" title="Permanent link">&para;</a></h4>
<p>In the motivating example, we showed how the Poisson equation <span class="arithmatex">\(\Delta u(X) = f(X)\)</span> became a linear system <span class="arithmatex">\(Au=f\)</span> after FEM discretization, where <span class="arithmatex">\(f_i = \int_{\Omega} f(X) \phi_i(X) \partial \Omega\)</span>. However, this form is impractical, because for every different forcing function <span class="arithmatex">\(f(X)\)</span>, a different integral expression would have to be generated to compute <span class="arithmatex">\(f\)</span>. Instead, we will often discretize "known" forcing functions, i.e. <em>load vectors</em>, as these piece-wise (per element) polynomial functions <span class="arithmatex">\(f(X) = f_e(X) \in \mathbb{R}^{d}\)</span> for <span class="arithmatex">\(X \in \Omega^e\)</span>. This allows us to compute the <em>load vector</em> <span class="arithmatex">\(f\)</span> as</p>
<div class="arithmatex">\[
f_i = \int_{\Omega} f(X) \phi_i(X) \partial \Omega = \sum_e \int_{\Omega^e} f_e(X) \phi_i(X) \partial \Omega^e ,
\]</div>
<p>since the <span class="arithmatex">\(f_e(X)\)</span> are polynomial in their corresponding element. If <span class="arithmatex">\(f_e(X)\)</span> has order <span class="arithmatex">\(p_f\)</span> and <span class="arithmatex">\(\phi_i(X)\)</span> is of order <span class="arithmatex">\(p_\phi\)</span>, then a polynomial quadrature rule of order <span class="arithmatex">\(p=p_f + p_\phi\)</span> is exact, and we obtain </p>
<div class="arithmatex">\[
\int_{\Omega^e} f_e(X) \phi_i(X) \partial \Omega^e = \sum_g \left[ w_g |\det \nabla_\xi X(\xi_g)| \right] f_e(X(\xi_g)) \phi_i(X(\xi_g)) .
\]</div>
<p>We can thus construct the matrix <span class="arithmatex">\(F \in \mathbb{R}^{|E|q \times d}\)</span>, whose block rows <span class="arithmatex">\(F_e \in \mathbb{R}^{q \times d}\)</span> contain values of the forcing function <span class="arithmatex">\(f_e\)</span> evaluated at <span class="arithmatex">\(e\)</span>'s quadrature points <span class="arithmatex">\(X(\xi_g)\)</span>, and compute the load vector <span class="arithmatex">\(f\)</span> under Galerkin projection as </p>
<div class="arithmatex">\[
f = N^T Q F \in \mathbb{R}^{n \times d} 
\]</div>
<p>with exact integration, given a quadrature matrix <span class="arithmatex">\(Q\)</span> discretized for order <span class="arithmatex">\(p\)</span> integrands.</p>
<p>In the special case that <span class="arithmatex">\(f(X)\)</span> is piece-wise constant, the element integrals become <span class="arithmatex">\(f_e(X) \int_{\Omega^e} \phi_i(X) \partial \Omega^e\)</span> in each element, such that <span class="arithmatex">\(\int_{\Omega^e} \phi_i(X) \partial \Omega^e\)</span> can instead be precomputed and re-used for any new piece-wise constant forcing function <span class="arithmatex">\(f(X) = f_e(X)\)</span>. In this case, <span class="arithmatex">\(p = p_\phi\)</span>, and basis function integrals <span class="arithmatex">\(\int_{\Omega^e} \phi_i(X) \partial \Omega^e\)</span> are precomputed into <span class="arithmatex">\(B = N^T Q 1_{|E|q}\)</span>. Then, different load vectors can be computed for any piece-wise constant function <span class="arithmatex">\(f(X) = f_e(X)\)</span> discretized in <span class="arithmatex">\(F\)</span> for a quadrature order <span class="arithmatex">\(p\)</span> as </p>
<div class="arithmatex">\[
f = B F \in \mathbb{R}^{n \times d} .
\]</div>
<h4 id="mass-matrix">Mass matrix<a class="headerlink" href="#mass-matrix" title="Permanent link">&para;</a></h4>
<p>Another approach is to directly discretize the forcing function <span class="arithmatex">\(f(X) \approx \sum_j f_j \phi_j(X)\)</span> in the same function space as the FEM solution. Under the Galerkin projection, we would thus get </p>
<div class="arithmatex">\[
\int_{\Omega} f(X) \partial \Omega = \sum_j f_j \int_{\Omega} \phi_i(X) \phi_j(X) \partial \Omega .
\]</div>
<p>In matrix notation, this is exactly <span class="arithmatex">\(Mf\)</span>, where <span class="arithmatex">\(M \in \mathbb{R}^{n \times n}\)</span> and <span class="arithmatex">\(f \in \mathbb{R}^{n \times 1}\)</span> and the entries <span class="arithmatex">\(M_{ij} = \int_{\Omega} \phi_i(X) \phi_j(X) \partial \Omega\)</span>. The forcing function <span class="arithmatex">\(f(X)\)</span> may thus be user-defined purely by specifying function values <span class="arithmatex">\(f_i\)</span> at the mesh nodes <span class="arithmatex">\(i\)</span>, rather than at mesh elements <span class="arithmatex">\(e\)</span> as in the previous section. If <span class="arithmatex">\(\phi_i(X)\)</span> is a polynomial of order <span class="arithmatex">\(p\)</span>, then mass matrix entries have polynomial integrands of order <span class="arithmatex">\(2p\)</span>. Thus, the mass matrix can be computed exactly using a polynomial quadrature rule of order <span class="arithmatex">\(2p\)</span>.</p>
<p>Using this approach, the earlier Poisson problem would be discretized into <span class="arithmatex">\(Au = Mf\)</span>. Many other PDEs involving known functions make the mass matrix appear. The dot product <span class="arithmatex">\(u(X)^T v(X)\)</span> of 2 functions <span class="arithmatex">\(u(X) = \sum_i u_i \phi_i(X)\)</span> and <span class="arithmatex">\(v(X) = \sum_i v_i \phi_i(X)\)</span> discretized in FEM's solution space, with coefficients vectors <span class="arithmatex">\(u\)</span> and <span class="arithmatex">\(v\)</span>, will similarly make the mass matrix appear as <span class="arithmatex">\(u(X)^T v(X) = u^T M v\)</span>. We can thus think of the mass matrix as a suitable inner product matrix which enjoys the desirable property of being symmetric and positive definite.</p>
<p>Again, because each element uniquely contributes to its nodes' basis function integrals, we can compute and store per-element mass matrices independently as </p>
<div class="arithmatex">\[
M^e = 
\begin{bmatrix} 
\int_{\Omega^e} \phi_1 \phi_1 \partial \Omega^e &amp; \dots &amp; \int_{\Omega^e} \phi_1 \phi_{n^e} \partial \Omega^e \\ 
\vdots &amp;  &amp; \vdots \\ 
\int_{\Omega^e} \phi_{n^e} \phi_1 \partial \Omega^e &amp; \dots &amp; \int_{\Omega^e} \phi_{n^e} \phi_{n^e} \partial \Omega^e 
\end{bmatrix} ,
\]</div>
<p>using local node indices <span class="arithmatex">\(l=1,2,\dots,n^e\)</span> which are then accumulated (i.e. summed) into the global mass matrix <span class="arithmatex">\(M\)</span> by mapping local indices <span class="arithmatex">\(l\)</span> into corresponding global indices <span class="arithmatex">\(i\)</span> and <span class="arithmatex">\(j\)</span> for rows and columns. We call these the element mass matrices.</p>
<p>It is possible to associate physical meaning to the mass matrix by injecting into its integral form a measure of mass density <span class="arithmatex">\(\rho\)</span> (i.e. grams per unit volume). If the mass density is specified as piece-wise constants (per element) <span class="arithmatex">\(\rho_e\)</span>, then we simply scale each element mass matrix as <span class="arithmatex">\(\rho_e M^e\)</span> and sum the scaled element mass matrices into the global mass matrix <span class="arithmatex">\(M\)</span>.</p>
<p>If we use our previously defined quadrature matrix <span class="arithmatex">\(Q\)</span> and shape function matrix <span class="arithmatex">\(N\)</span> of quadrature order <span class="arithmatex">\(2p\)</span>, then we can simply write</p>
<div class="arithmatex">\[
M = N^T Q N \in \mathbb{R}^{n \times n} .
\]</div>
<p>With this construction, the inner product structure of <span class="arithmatex">\(M\)</span> is even more obvious. The product <span class="arithmatex">\(u^T M v = u^T N^T Q N v\)</span> immediately reveals that we are integrating <span class="arithmatex">\(\langle u, v \rangle\)</span> for functions <span class="arithmatex">\(u, v\)</span> discretized on the mesh using shape functions <span class="arithmatex">\(N\)</span>.</p>
<h4 id="gradient-matrix">Gradient matrix<a class="headerlink" href="#gradient-matrix" title="Permanent link">&para;</a></h4>
<p>Computing the gradient <span class="arithmatex">\(\nabla u(X)\)</span> amounts to simply <span class="arithmatex">\(\sum_i u_i \nabla \phi_i(X)\)</span>. This leads to defining <span class="arithmatex">\(G\)</span> similarly to <span class="arithmatex">\(N\)</span>, except we now inject the shape function derivatives <span class="arithmatex">\(\frac{\partial \phi_i(X(\xi_g))}{\partial X_k}\)</span> for the <span class="arithmatex">\(k^\text{th}\)</span> dimension, evaluated at element <span class="arithmatex">\(e\)</span>'s quadrature points <span class="arithmatex">\(X(\xi_g)\)</span>, in the <span class="arithmatex">\(e^{\text{th}}\)</span> block row.</p>
<p>This leads to defining the Galerkin gradient matrix for <span class="arithmatex">\(X\)</span> of dimensions <span class="arithmatex">\(d\)</span> via its block rows, as </p>
<div class="arithmatex">\[
G^k_{e} = \begin{bmatrix}
\frac{\partial \phi_1(X(\xi_1))}{\partial X_k} &amp; \dots &amp; \frac{\partial \phi_n(X(\xi_1))}{\partial X_k} \\
\vdots &amp; \ddots &amp; \vdots\\
\frac{\partial \phi_1(X(\xi_q))}{\partial X_k} &amp; \dots &amp; \frac{\partial \phi_n(X(\xi_q))}{\partial X_k} \\
\end{bmatrix} \in \mathbb{R}^{q \times n}.
\]</div>
<p>As in the case of <span class="arithmatex">\(N\)</span>, only the shape function derivatives of element <span class="arithmatex">\(e\)</span> are non-zero in this block row, such that <span class="arithmatex">\(G^k_e\)</span> is sparse. We store the gradients separately per dimension, as </p>
<div class="arithmatex">\[
G^k = \begin{bmatrix}
G^k_1 \\ 
\vdots \\ 
G^k_{|E|} \\
\end{bmatrix} \in \mathbb{R}^{|E|q \times n} ,
\]</div>
<p>and then stack them vertically into </p>
<div class="arithmatex">\[
G = \begin{bmatrix}
G^1 \\
\vdots \\
G^d
\end{bmatrix} \in \mathbb{R}^{d|E|q \times n} .
\]</div>
<p>The application of <span class="arithmatex">\(G\)</span> onto <span class="arithmatex">\(u\)</span> thus computes each spatial derivative of <span class="arithmatex">\(u\)</span> at element quadrature points. Each <span class="arithmatex">\(G^k u\)</span> computes the <span class="arithmatex">\(k^\text{th}\)</span> spatial derivative of <span class="arithmatex">\(u(X)\)</span> at all element quadrature points, and each <span class="arithmatex">\(G^k_e u\)</span> computes its <span class="arithmatex">\(k^\text{th}\)</span> spatial derivative at element <span class="arithmatex">\(e\)</span>'s quadrature points.</p>
<p>If the gradient appears in the problem (i.e. PDE or other) itself, and the problem has been closed under Galerkin projection, we must now compute the "Galerkin" version of the gradient, i.e. <span class="arithmatex">\(\int_{\Omega} \nabla u(X) \phi_i(X) \partial \Omega = \langle \nabla u, \phi_i \rangle\)</span>. By approximation and linearity of the gradient operator, such an expression becomes </p>
<div class="arithmatex">\[
\int_{\Omega} \nabla u(X) \phi_i(X) \partial \Omega = \sum_j u_j \int_{\Omega} \phi_i(X) \nabla \phi_j(X) \partial \Omega .
\]</div>
<p>If <span class="arithmatex">\(\phi_i\)</span> has order <span class="arithmatex">\(p\)</span>, then <span class="arithmatex">\(\phi_i \nabla \phi_j\)</span> has order <span class="arithmatex">\(2p - 1\)</span>. Thus, armed with the quadrature matrix <span class="arithmatex">\(Q\)</span> and shape function matrix <span class="arithmatex">\(N\)</span> of quadrature order <span class="arithmatex">\(2p - 1\)</span>, </p>
<div class="arithmatex">\[
\left[ I_{d \times d} \otimes N^T Q \right] G u = \bar{G} u
\]</div>
<p>computes the gradient in the Galerkin sense, where <span class="arithmatex">\(I_{d \times d}\)</span> is the identity matrix and <span class="arithmatex">\(\bar{G}\)</span> is the Galerkin projected gradient operator. Its entries are </p>
<div class="arithmatex">\[
\bar{G}^k_{ij} = \int_{\Omega} \phi_i(X) \frac{\partial \phi_j(X)}{\partial X_k} \partial \Omega 
\]</div>
<p>for <span class="arithmatex">\(k=1,2,\dots,d\)</span>. </p>
<h4 id="laplacian-matrix">Laplacian matrix<a class="headerlink" href="#laplacian-matrix" title="Permanent link">&para;</a></h4>
<p>The Poisson problem discretized the Laplacian matrix into <span class="arithmatex">\(A\)</span> where <span class="arithmatex">\(A_{ij} = \int_{\Omega} \phi_i(X) \Delta \phi_j(X) \partial \Omega\)</span>. However, this results in a non-symmetric matrix, and requires shape functions of order <span class="arithmatex">\(p \geq 2\)</span>, meaning we wouldn't be able to use linear shape functions to solve a problem involving the Laplacian of the solution. Thus, in practice, we will make use of multivariable integration by parts, i.e. <a href="https://en.wikipedia.org/wiki/Green%27s_identities">Green's identities</a>, to transform <span class="arithmatex">\(\Delta u(X)\)</span> into</p>
<div class="arithmatex">\[
\sum_j u_j \int_{\Omega} \phi_i(X) \Delta \phi_j(X) \partial \Omega = \sum_j u_j 
\left[
\int_{\Omega} -\nabla \phi_i(X) \cdot \nabla \phi_j(X) \partial \Omega + 
\int_{\partial \Omega} \phi_i(X) \nabla \phi_j(X) \cdot n \partial S
\right] .
\]</div>
<div class="arithmatex">\[
Au = Lu + Nu
\]</div>
<p>Here, <span class="arithmatex">\(\int_{\partial \Omega} \partial S\)</span> is to be interpreted as a boundary integral (over <span class="arithmatex">\(\Omega\)</span>'s boundary) with <span class="arithmatex">\(n\)</span> being the boundary's normal. The integration by parts reveals the symmetric Laplacian matrix <span class="arithmatex">\(L \in \mathbb{R}^{n \times n}\)</span>, and the Neumann matrix <span class="arithmatex">\(N \in \mathbb{R}^{n \times n}\)</span>. In fact, <span class="arithmatex">\(L\)</span> is desirably both symmetric and negative semi-definite (with only rank-1 deficiency). If Neumann boundary conditions have been specified as a known function </p>
<div class="arithmatex">\[
g(X) = \nabla u(X) \cdot n 
\]</div>
<p>on the domain's boundary, i.e. <span class="arithmatex">\(X \in \partial \Omega\)</span>, then we replace <span class="arithmatex">\(Nu\)</span> by <span class="arithmatex">\(g \in \mathbb{R}^{n \times n}\)</span> such that <span class="arithmatex">\(g_i = \int_{\partial \Omega} g(X) \phi_i(X) \partial S\)</span>. Because this integral is defined over the boundary of the FEM meshing of <span class="arithmatex">\(\Omega\)</span>, we can similarly extract the boundary mesh for <span class="arithmatex">\(\partial \Omega\)</span>, preserving node indexing. We can then discretize <span class="arithmatex">\(g(X)\)</span> on this boundary mesh using FEM once again as either a load vector if <span class="arithmatex">\(g(X)\)</span> is defined on boundary faces, or as <span class="arithmatex">\(Mg\)</span> using the boundary mesh's mass matrix <span class="arithmatex">\(M\)</span> and coefficients <span class="arithmatex">\(g\)</span> defined on boundary vertices. There are many cases where the Neumann boundary conditions are even simpler, however, i.e. when <span class="arithmatex">\(g(X) = \nabla u(X) \cdot n = 0\)</span>, in which case the Laplacian matrix is exactly <span class="arithmatex">\(L\)</span>. The resulting Poisson problem would then be <span class="arithmatex">\(Lu=f\)</span>, which is a symmetric negative semi-definite linear system which can be solved efficiently.</p>
<p>The matrix <span class="arithmatex">\(L\)</span> is quite famous and is equivalent to the so-called <a href="https://en.wikipedia.org/wiki/Discrete_Laplace_operator#Mesh_Laplacians">"cotangent Laplacian"</a> or the "Laplace-Beltrami" operator mentioned in the literature, for the case of triangular meshes embedded in 3D. Instead of the general derivation presented in this document, when assuming linear shape functions, it is possible to derive quite elegant analytic expressions involving the cotangent function to compute its entries. In our Physics Based Animation Toolkit, we also like to refer to <span class="arithmatex">\(L\)</span> as the symmetric part of the Laplacian matrix. If <span class="arithmatex">\(\phi_i(X)\)</span> is of polynomial order <span class="arithmatex">\(p\)</span>, then <span class="arithmatex">\(L\)</span>'s integrands are polynomials of order <span class="arithmatex">\(2(p-1)\)</span>. A polynomial quadrature rule of order <span class="arithmatex">\(2(p-1)\)</span> is thus sufficient for exact computation of <span class="arithmatex">\(L\)</span>.</p>
<p>The element Laplacian matrices are</p>
<div class="arithmatex">\[
L^e = 
-\begin{bmatrix} 
\int_{\Omega^e} \nabla \phi_1 \nabla \phi_1 \partial \Omega^e &amp; \dots &amp; \int_{\Omega^e} \nabla \phi_1 \nabla \phi_{n^e} \partial \Omega^e \\ 
\vdots &amp;  &amp; \vdots \\ 
\int_{\Omega^e} \nabla \phi_{n^e} \nabla \phi_1 \partial \Omega^e &amp; \dots &amp; \int_{\Omega^e} \nabla \phi_{n^e} \nabla \phi_{n^e} \partial \Omega^e 
\end{bmatrix} ,
\]</div>
<p>where local indexing <span class="arithmatex">\(l =1,2,\dots,n^e\)</span> has been used.</p>
<p>Once again, we can reuse our previously defined operators to construct the Laplacian instead. Using the matrices <span class="arithmatex">\(Q\)</span> and <span class="arithmatex">\(G\)</span> of appropriate quadrature order, we get that</p>
<div class="arithmatex">\[
L = -G^T \left[ I_{d \times d} \otimes Q \right] G \in \mathbb{R}^{n \times n} .
\]</div>
<h4 id="divergence-matrix">Divergence matrix<a class="headerlink" href="#divergence-matrix" title="Permanent link">&para;</a></h4>
<p>Interestingly, we can discretize the <a href="https://en.wikipedia.org/wiki/Divergence">divergence</a> operator by simply transposing the gradient matrix, i.e. <span class="arithmatex">\(D = G^T \in \mathbb{R}^{n \times d|E|q}\)</span>. Given some vector field <span class="arithmatex">\(F(X)\)</span> discretized at element quadrature points <span class="arithmatex">\(X(\xi_g)\)</span>, where each scalar field component <span class="arithmatex">\(F_k(X)\)</span> of <span class="arithmatex">\(F(X)\)</span> has been discretized into <span class="arithmatex">\(F_k \in \mathbb{R}^{|E|q \times 1}\)</span> and stacked into <span class="arithmatex">\(F \in \mathbb{R}^{d|E|q \times 1}\)</span>, </p>
<div class="arithmatex">\[
DF = G^T F \in \mathbb{R}^{n \times 1}
\]</div>
<p>computes its divergence. However, in the previous construction of the Laplacian, or more precisely, the symmetric part of the Galerkin projected Laplacian, we had that </p>
<div class="arithmatex">\[
L = -G^T \left[ I_{d \times d} \otimes Q \right] G = \left[ -D \left(I_{d \times d} \otimes Q \right) \right] G ,
\]</div>
<p>where the divergence operator <span class="arithmatex">\(D\)</span> must act on the gradient <span class="arithmatex">\(G\)</span> of an FEM function through integration. As such, when solving problems involving divergence, such as least-squares gradient matching problems, i.e. the Poisson problem</p>
<div class="arithmatex">\[
\min_u ||\nabla u - F||_2^2 \leftrightarrow \Delta u = \nabla \cdot F ,
\]</div>
<p>the divergence operator should act on the target vector field <span class="arithmatex">\(F(X)\)</span> in the integrated (i.e. Galerkin) sense. In matrix notation, we discretize the divergence of the target vector field <span class="arithmatex">\(F(X)\)</span> as <span class="arithmatex">\(-D \left[ I_{d \times d} \otimes Q \right] F\)</span>, for discrete <span class="arithmatex">\(F\)</span> constructed as in previous examples.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 7, 2024</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "toc.follow", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../../_static/javascripts/config.js"></script>
      
        <script src="../../../_static/javascripts/custom.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/rod2ik/cdn@main/mkdocs/javascripts/mkdocs-graphviz.js"></script>
      
    
  </body>
</html>