
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Physics Based Animation Toolkit.">
      
      
        <meta name="author" content="Quoc-Minh Ton-That">
      
      
        <link rel="canonical" href="https://github.com/Q-Minh/PhysicsBasedAnimationToolkit/course/fem/shape_functions/">
      
      
        <link rel="prev" href="../method/">
      
      
        <link rel="next" href="../spatial_integration/">
      
      
      <link rel="icon" href="../../../_static/imgs/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Shape Functions - Physics Based Animation Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../_static/stylesheets/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#shape-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Physics Based Animation Toolkit" class="md-header__button md-logo" aria-label="Physics Based Animation Toolkit" data-md-component="logo">
      
  <img src="../../../_static/imgs/pbat.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Physics Based Animation Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Shape Functions
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Q-Minh/PhysicsBasedAnimationToolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Q-Minh/PhysicsBasedAnimationToolkit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../c%2B%2B/cpp/" class="md-tabs__link">
          
  
  C++

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../python/python/" class="md-tabs__link">
          
  
  Python

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../workshops/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  FEM

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../math/" class="md-tabs__link">
          
  
  Math

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Physics Based Animation Toolkit" class="md-nav__button md-logo" aria-label="Physics Based Animation Toolkit" data-md-component="logo">
      
  <img src="../../../_static/imgs/pbat.svg" alt="logo">

    </a>
    Physics Based Animation Toolkit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Q-Minh/PhysicsBasedAnimationToolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Q-Minh/PhysicsBasedAnimationToolkit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PBAT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gallery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gallery
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    C++
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            C++
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../c%2B%2B/cpp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../c%2B%2B/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../c%2B%2B/cuda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CUDA
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/FEM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FEM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/geometry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/profiling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/math/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Math
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPU
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Workshops
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Workshops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../workshops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/broad_phase/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Broad Phase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/contact_detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contact Detection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/diffusion_smoothing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diffusion Smoothing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Elasticity
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Elasticity
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/elasticity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elasticity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/elasticity_higher_order/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Higher Order
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/heat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    IPC
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            IPC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/ipc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IPC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/ipc-multi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Material
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/laplace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Laplace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/vbd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VBD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/xpdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XPDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    FEM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            FEM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../method/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Method
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Shape Functions
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Shape Functions
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shape-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Shape functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Shape functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lagrange-elements" class="md-nav__link">
    <span class="md-ellipsis">
      Lagrange elements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-fromto-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Mapping from/to reference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      Derivatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spatial_integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spatial Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../boundary_conditions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Boundary Conditions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vector_valued_functions.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vector-valued Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../limitations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Limitations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Math
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Math
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear_algebra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear Algebra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/optimization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shape-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Shape functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Shape functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lagrange-elements" class="md-nav__link">
    <span class="md-ellipsis">
      Lagrange elements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-fromto-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Mapping from/to reference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      Derivatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Shape Functions</h1>

<h3 id="shape-functions">Shape functions<a class="headerlink" href="#shape-functions" title="Permanent link">&para;</a></h3>
<p>Although our motivating example shows how, armed with basis functions <span class="arithmatex">\(\phi_i\)</span>, continuous problems reduce to discrete ones, we have yet to explicitly define such functions. However, we did <em>implicitly</em> define them by stating that they must satisfy the following properties
1. <span class="arithmatex">\(\phi_i\)</span> is a polynomial
2. <span class="arithmatex">\(\phi_i(X_j) = \delta_{ij}\)</span>
3. <span class="arithmatex">\(<code>\phi_i(X) = \begin{cases}N_i^e(X) &amp; X \in \Omega^e, \text{node} \;i\; \text{and element} \;e\; \text{are adjacent}\\ 0 &amp; \text{otherwise}\end{cases}</code>\)</span></p>
<p>The third property introduces <span class="arithmatex">\(\Omega^e\)</span>, which refers to the domain of element <span class="arithmatex">\(e\)</span>, i.e. the space it occupies. Naturally, meshes are made of non-overlapping geometric primitives (i.e. the "elements" <span class="arithmatex">\(\Omega^e\)</span>), connected through their boundaries. This means that evaluating <span class="arithmatex">\(\phi_i(X)\)</span> is achieved by the following steps.
1. Find which element <span class="arithmatex">\(e\)</span> contains the point <span class="arithmatex">\(X\)</span>. 
2. Evaluate <span class="arithmatex">\(N_i^e(X)\)</span>.</p>
<p>Fortunately, our shape functions have <span class="arithmatex">\(C^0\)</span> continuity at element boundaries, meaning <span class="arithmatex">\(N_i^e(X) = N_i^{e'}(X)\)</span> on the boundary between adjacent elements <span class="arithmatex">\(e\)</span> and <span class="arithmatex">\(e'\)</span> (due to uniqueness of interpolating polynomials). Hence, if a point <span class="arithmatex">\(X\)</span> lies on the boundary between 2 or more elements, we can pick any of these elements in step 1.</p>
<p>We now focus on the secret sauce, the element shape functions <span class="arithmatex">\(N_i^e(X)\)</span>. Properties 1. and 3. state that <span class="arithmatex">\(\phi_i(X)\)</span> is a polynomial and evaluates to <span class="arithmatex">\(N_i^e(X)\)</span> on the element <span class="arithmatex">\(e\)</span>. Thus, <span class="arithmatex">\(N_i^e(X)\)</span> is a polynomial on the element <span class="arithmatex">\(e\)</span>. Polynomials can be written as linear combinations of basis polynomials <span class="arithmatex">\(P_k(X)\)</span>. Suppose that <span class="arithmatex">\(n^e = |\text{nodes}(e)|\)</span>, then if we have <span class="arithmatex">\(n^e\)</span> such basis polynomials <span class="arithmatex">\(P_k(X)\)</span>, and we have that $N_i^e(X) = \sum_{j \in \text{nodes}(e)} \alpha_{ij} P_j(X) $. More compactly,</p>
<div class="arithmatex">\[
N_i^e(X) = P(X)^T \alpha_i ,
\]</div>
<p>where <span class="arithmatex">\(<code>P(X) = \begin{bmatrix} P_1(X) &amp; \dots &amp; P_{n^e}(X) \end{bmatrix}^T</code>\)</span> and <span class="arithmatex">\(<code>\alpha_i = \begin{bmatrix} \alpha_{i1} &amp; \dots &amp; \alpha_{in^e} \end{bmatrix}^T</code>\)</span>. Property 2, i.e. the Kronecker delta property, thus translates into <span class="arithmatex">\(N_i^e(X_j) = \delta_{ij}\)</span> on element <span class="arithmatex">\(e\)</span>. Substituting <span class="arithmatex">\(N_i^e(X_j)\)</span> for its polynomial expansion in the Kronecker delta property yields</p>
<div class="arithmatex">\[
\begin{bmatrix} P(X_1) &amp; \dots &amp; P(X_{n^e}) \end{bmatrix}^T \begin{bmatrix} \alpha_1 &amp; \dots &amp; \alpha_{n^e} \end{bmatrix} = I_{n^e \times n^e} ,
\]</div>
<p>where <span class="arithmatex">\(I_{n^e \times n^e} \in \mathbb{R}^{n^e \times n^e}\)</span> is the identity matrix. In matrix notation,</p>
<div class="arithmatex">\[
P^T \alpha = I_{n^e \times n^e} ,
\]</div>
<p>where we have conveniently numbered the nodes of element <span class="arithmatex">\(e\)</span> as <span class="arithmatex">\(l=1,2,\dots,n^e\)</span>. This numbering choice is often referred to as the "local" indexing of the nodes of element <span class="arithmatex">\(e\)</span>. The "global" indexing of these same nodes refers to the actual nodal indices <span class="arithmatex">\(i\)</span> corresponding to local nodal indices <span class="arithmatex">\(l\)</span>.</p>
<p>The polynomial basis generally has a quite simple analytical form. For example, taking the monomial basis in 1D for a quadratic polynomial yields <span class="arithmatex">\(P_1(X) = 1, P_2(X) = X, P_3(X) = X^2\)</span>. A linear monomial basis in 3D yields <span class="arithmatex">\(P_1(X)=1, P_2(X) = X_1, P_3(X) = X_2, P_4(X)=X_3\)</span>. These basis polynomials are thus super easy to evaluate, differentiate or integrate in code. What we really need is to find the coefficients <span class="arithmatex">\(\alpha_{ij}\)</span> that will finalize our definition of the shape functions <span class="arithmatex">\(N_i^e(X)\)</span>. Fortunately, solving the Kronecker equation above amounts to computing the inverse of the transposed matrix of polynomials <span class="arithmatex">\(P^T\)</span> </p>
<div class="arithmatex">\[
\alpha = P^{-T} .
\]</div>
<p>Armed with each matrix <span class="arithmatex">\(A\)</span> stored for its corresponding element in an FEM computer program, we can easily evaluate <span class="arithmatex">\(\phi_i(X)\)</span> by finding an element <span class="arithmatex">\(e\)</span> containing point <span class="arithmatex">\(X\)</span>, converting global node index <span class="arithmatex">\(i\)</span> into its corresponding local index <span class="arithmatex">\(l\)</span>, and returning <span class="arithmatex">\(P(X)^T \alpha_{l}\)</span>. Fortunately, these polynomial coefficient matrices <span class="arithmatex">\(A\)</span> are to be precomputed only once, in parallel, for each element.</p>
<p>Unfortunately, <span class="arithmatex">\(P^T\)</span> can easily become <a href="https://en.wikipedia.org/wiki/Condition_number">ill-conditioned</a>, which makes its inversion <a href="https://en.wikipedia.org/wiki/Numerical_stability">numerically unstable</a>, especially for higher-order polynomial basis'. This phenomenon depends on the geometry of the mesh elements, i.e. the positions of the nodes <span class="arithmatex">\(X_i\)</span>. Intuitively, ill-conditioning of <span class="arithmatex">\(P^T\)</span> means that some of its cofficients are really large (in magnitude), and some of them are really small (in magnitude). Taking as an example the 1D quadratic monomial evaluated at some element's node with position <span class="arithmatex">\(X=1000\)</span>, we get that its corresponding row in <span class="arithmatex">\(P^T\)</span> would be <span class="arithmatex">\(<code>\begin{bmatrix}1 &amp; 1000 &amp; 1000000\end{bmatrix}</code>\)</span>. Clearly, this is ill-conditioned. </p>
<p>To address this issue, it is common in practice to define some map <span class="arithmatex">\(X(\xi)\)</span> that takes points in some <em>reference</em> space to the domain <span class="arithmatex">\(\Omega\)</span>, and its inverse <span class="arithmatex">\(\xi(X) = X^{-1}(\xi)\)</span> such that we can construct shape functions in the reference space, where the geometry of the elements will yield well-conditioned <span class="arithmatex">\(P^T\)</span>. In fact, this concept leads to defining the so-called <em>reference elements</em>. The maps <span class="arithmatex">\(X(\xi)\)</span> and <span class="arithmatex">\(\xi(X)\)</span> are then defined per-element, and always map from and to the reference element, respectively. Reference shape functions are subsequently defined on the reference element and constructed only once. Evaluating a basis function <span class="arithmatex">\(\phi_i(X)\)</span> on element <span class="arithmatex">\(e\)</span> thus amounts to mapping <span class="arithmatex">\(X\)</span> to <span class="arithmatex">\(\xi\)</span> using element <span class="arithmatex">\(e\)</span>'s inverse map <span class="arithmatex">\(\xi(X)\)</span>, and then evaluating the reference shape function associated with node <span class="arithmatex">\(i\)</span> of element <span class="arithmatex">\(e\)</span>. Mathematically, assuming that <span class="arithmatex">\(N_l(\xi)\)</span> is the reference shape function for domain node <span class="arithmatex">\(i\)</span> associated with reference node <span class="arithmatex">\(l\)</span> on the reference element, we have that</p>
<div class="arithmatex">\[
\phi_i(X) = N_l(\xi(X)) .
\]</div>
<p><a href="https://hplgit.github.io/INF5620/doc/pub/main_fem.pdf#page=81.67">Chapter 9.3 of Hans Petter Langtangen's FEM book</a> (highly recommend that book) provides the following pedagogical visuals, in which dots represent nodes of a quadratic FEM triangular element.</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><img alt="FEM reference to domain linear map" src="../../../_static/imgs/p2.triangle.affine.map.png" /></th>
<th style="text-align: center;"><img alt="FEM reference to domain non-linear map" src="../../../_static/imgs/p2.triangle.isoparametric.map.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Linear map from reference element (local) to domain element (global).</td>
<td style="text-align: center;">Non-linear map from reference element (local) to domain element (global).</td>
</tr>
</tbody>
</table>
<h4 id="lagrange-elements">Lagrange elements<a class="headerlink" href="#lagrange-elements" title="Permanent link">&para;</a></h4>
<p>Perhaps the simplest and/or most popular type of reference element is the <a href="https://doc.comsol.com/5.3/doc/com.comsol.help.comsol/comsol_api_xmesh.40.4.html">Lagrange element</a>. This type of element is defined by a polynomial order <span class="arithmatex">\(p\)</span> used to construct the shape functions. As described above, there must be as many polynomial basis' as nodes for the inverse of <span class="arithmatex">\(P^T\)</span> to exist, i.e. <span class="arithmatex">\(P^T\)</span> must be square. Lagrange elements in 3D thus define their nodes with coordinates <span class="arithmatex">\(<code>\xi_l \in \left\{ \left(\frac{a}{p}, \frac{b}{p}, \frac{c}{p}\right) \right\}</code>\)</span>
and corresponding polynomial basis functions <span class="arithmatex">\(<code>P_l \in \left\{ \xi_x^a \xi_y^b \xi_z^c \right\}</code>\)</span> for integer values <span class="arithmatex">\(0 \leq a,b,c \leq p\)</span>, where they are used as powers. In 2D, we only use <span class="arithmatex">\(a\)</span> and <span class="arithmatex">\(b\)</span>. In 1D, we reduce further to simply using <span class="arithmatex">\(a\)</span>. Simplex elements, such as triangles and tetrahedra have the additional constraint <span class="arithmatex">\(a+b+c \leq p\)</span>, wheras line segments, quadrilaterals and hexahedra do not.</p>
<p>Taken once again from <a href="https://hplgit.github.io/INF5620/doc/pub/main_fem.pdf#page=81.67">chapter 9.3 of Hans Petter Langtangen's FEM book</a>, here are examples of Lagrange elements and their nodes in dimensions <code>1,2,3</code>.</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><img alt="P1 Lagrange simplex elements" src="../../../_static/imgs/p1.lagrange.simplex.elements.png" /></th>
<th style="text-align: center;"><img alt="P2 Lagrange simplex elements" src="../../../_static/imgs/p2.lagrange.simplex.elements.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Linear Lagrange simplex elements.</td>
<td style="text-align: center;">Quadratic Lagrange simplex elements.</td>
</tr>
</tbody>
</table>
<h4 id="mapping-fromto-reference">Mapping from/to reference<a class="headerlink" href="#mapping-fromto-reference" title="Permanent link">&para;</a></h4>
<p>Given exact reference node placements <span class="arithmatex">\(\xi_l\)</span> and the polynomial basis functions <span class="arithmatex">\(P_l(\xi)\)</span>, we can obtain our reference shape functions <span class="arithmatex">\(N_l(\xi) = P(\xi)^T \alpha_l\)</span>. We can recover the map <span class="arithmatex">\(X(\xi)\)</span> easily by simple interpolation of domain positions <span class="arithmatex">\(X_i\)</span> of domain nodes and elements, <span class="arithmatex">\(i\)</span> and <span class="arithmatex">\(e\)</span>, stored on corresponding reference nodes <span class="arithmatex">\(l\)</span> with positions <span class="arithmatex">\(\xi_l\)</span> and shape functions <span class="arithmatex">\(N_l(\xi)\)</span> on the reference element. Mathematically, we write the map as</p>
<div class="arithmatex">\[
X(\xi) = X^e N(\xi) ,
\]</div>
<p>where <span class="arithmatex">\(<code>X^e = \begin{bmatrix} X_1 &amp; \dots &amp; X_{n^e} \end{bmatrix} \in \mathbb{R}^{d \times n^e}</code>\)</span> are element <span class="arithmatex">\(e\)</span>'s nodes' positions <span class="arithmatex">\(X_i\)</span>, <span class="arithmatex">\(<code>N(\xi) = \begin{bmatrix} N_1(\xi) &amp; \dots &amp; N_{n^e}(\xi) \end{bmatrix}^T \in \mathbb{R}^{n^e}</code>\)</span> are the reference shape functions evaluated at <span class="arithmatex">\(\xi\)</span>, and <span class="arithmatex">\(d\)</span> is the number of embedding dimensions for <span class="arithmatex">\(X_i\)</span>. </p>
<p>The inverse map <span class="arithmatex">\(\xi(X)\)</span> is, however, not so trivial in the general case. One way to obtain <span class="arithmatex">\(\xi(X)\)</span> numerically is by solving the non-linear least-squares problem</p>
<div class="arithmatex">\[
\min_{\xi} || X - X(\xi) ||_2^2 ,
\]</div>
<p>for which we can use a <a href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Newton_algorithm">Gauss-Newton algorithm</a>. If the map <span class="arithmatex">\(X(\xi)\)</span> is linear, however, its jacobian <span class="arithmatex">\(J\)</span> must be constant. We can choose an arbitrary point around which to perform a Taylor expansion of <span class="arithmatex">\(X(\xi)\)</span>, for example, the reference space's origin <span class="arithmatex">\(\xi_1 = 0\)</span>, which we know is mapped to <span class="arithmatex">\(X_1\)</span> in Lagrange elements, revealing </p>
<div class="arithmatex">\[
X(\xi) = X_1 + J \xi .
\]</div>
<p>If the reference element's dimensions match the domain's embedding dimensions, <span class="arithmatex">\(J\)</span> is square and</p>
<div class="arithmatex">\[
\xi(X) = J^{-1} (X - X_1) .
\]</div>
<p>Otherwise, the normal equations may be used to define it instead</p>
<div class="arithmatex">\[
\xi(X) = (J^T J)^{-1} J^T (X - X_1) .
\]</div>
<h4 id="derivatives">Derivatives<a class="headerlink" href="#derivatives" title="Permanent link">&para;</a></h4>
<p>Computing derivatives of basis functions <span class="arithmatex">\(\phi_i(X)\)</span> also amounts to computing derivatives of shape functions <span class="arithmatex">\(N_i^e(X)\)</span>. Because our shape functions are now defined in reference space, we must use the <a href="https://en.wikipedia.org/wiki/Chain_rule">chain rule of differentiation</a> to compute <span class="arithmatex">\(\nabla_X N_i^e(X) = \nabla_X N_l(\xi(X))\)</span>, such that </p>
<div class="arithmatex">\[
\nabla_X \phi_i(X) = \nabla_X N_i^e(X) = \nabla_\xi N_l(\xi(X)) \nabla_X \xi(X) 
\]</div>
<p>for <span class="arithmatex">\(X \in \Omega^e\)</span>.</p>
<p>The gradient of the reference shape functions with respect to reference positions is easy enough to compute, since we just need to differentiate polynomials <span class="arithmatex">\(\xi_x^a \xi_y^b \xi_z^c\)</span>. The jacobian <span class="arithmatex">\(\nabla_X \xi(X)\)</span> of the inverse map is, again, not so trivial in the general case. If a Gauss-Newton algorithm is used to compute <span class="arithmatex">\(\xi(X)\)</span> as described above, we need to compute and accumulate gradients of the Gauss-Newton iterations by chain rule. Once again, though, if the map is linear, we can use the previous derivations of the linear inverse map to get <span class="arithmatex">\(\nabla_X \xi(X)\)</span> as </p>
<div class="arithmatex">\[
\nabla_X \xi(X) = J^{-1}
\]</div>
<p>for a square jacobian <span class="arithmatex">\(J\)</span>, and </p>
<div class="arithmatex">\[
\nabla_X \xi(X) = (J^T J)^{-1} J^T
\]</div>
<p>for a non-square jacobian <span class="arithmatex">\(J\)</span>.</p>
<h4 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h4>
<p>Basis functions <span class="arithmatex">\(\phi_i(X)\)</span> are constructed piece-wise in mesh elements <span class="arithmatex">\(e\)</span> adjacent to node <span class="arithmatex">\(i\)</span> via element shape functions <span class="arithmatex">\(N_i^e(X)\)</span>. To evaluate <span class="arithmatex">\(\phi_i(X)\)</span>, we find element <span class="arithmatex">\(e\)</span> adjacent to node <span class="arithmatex">\(i\)</span> containing point <span class="arithmatex">\(X\)</span>, and evaluate <span class="arithmatex">\(N_i^e(X)\)</span>. The shape functions are polynomials which depend on the geometry of their associated element, and we compute them by inverting a matrix <span class="arithmatex">\(P^T\)</span> of polynomials evaluated at element <span class="arithmatex">\(e\)</span>'s nodes. To avoid ill-conditioning of the matrix inversion problem, we instead define a reference element that is well-conditioned, and construct reference shape functions <span class="arithmatex">\(N_l(\xi)\)</span> there. Evaluating our basis functions in the domain then amounts to <span class="arithmatex">\(\phi_i(X) = N_i^e(X) = N_l(\xi(X))\)</span>, where <span class="arithmatex">\(\xi(X)\)</span> is the inverse map taking domain positions <span class="arithmatex">\(X\)</span> to reference positions <span class="arithmatex">\(\xi\)</span>, as opposed to the map <span class="arithmatex">\(X(\xi)\)</span> which takes reference positions to domain positions. Gradients of basis functions can be computed by carrying out the chain rule of differentiation through <span class="arithmatex">\(N_l(\xi)\)</span> and <span class="arithmatex">\(\xi(X)\)</span>. The specific placement of nodes and the associated basis polynomials in reference space defines the type of an FEM element. We present the classic Lagrange element as a simple yet popular choice.</p>
<p>Because functions discretized on an FEM mesh have a linear combination structure <span class="arithmatex">\(u(X) \approx \Phi^T u\)</span>, and <span class="arithmatex">\(u\)</span> is a simple vector of constant (with respect to <span class="arithmatex">\(X\)</span>) coefficients, differential operators <span class="arithmatex">\(D(\cdot)\)</span> applied to <span class="arithmatex">\(u(X)\)</span> need only be applied to the basis functions <span class="arithmatex">\(\phi_i(X)\)</span> by linearity. In other words, <span class="arithmatex">\(L(u(X)) = \sum_i u_i L(\phi_i(X))\)</span>. Hence, the gradient <span class="arithmatex">\(\nabla u(X)\)</span>, for example, amounts to <span class="arithmatex">\(\sum_i u_i \nabla \phi_i(X)\)</span>, where we have shown how to evaluate <span class="arithmatex">\(\nabla \phi_i(X)\)</span>. The same applies to other differential operators, such as <span class="arithmatex">\(\Delta, \nabla^2, \nabla \cdot, \int \partial\)</span>, etc.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 16, 2024</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "toc.follow", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../../_static/javascripts/config.js"></script>
      
        <script src="../../../_static/javascripts/custom.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/rod2ik/cdn@main/mkdocs/javascripts/mkdocs-graphviz.js"></script>
      
    
  </body>
</html>